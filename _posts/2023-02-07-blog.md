---
title: 'Python 利用selenium 控制浏览器自动提交表单'
date: 2021-11-25
permalink: /posts/2021/11/blog/
categories:
  - blog
tags:
  - python, tips
toc: true
---

---

---

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div>
<div class="button01">
      <visited_a href="#" display:inline><span id="busuanzi_container_site_pv">你是第<span id="busuanzi_value_site_pv"></span>位访客~</span></visited_a>
      <visited_p class="top">٩(๑^o^๑)۶</visited_p>
      <visited_p class="bottom">Σ(っ °Д °;)っ被你发现了！</visited_p>
</div>
<img align="center" width="100" src="{{ site.url }}/images/static/take_me.gif" alt="" display:inline>
</div>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8633559477921171"
     crossorigin="anonymous"></script>
---

## Python 利用selenium 自动控制浏览器提交表单

### 前期准备

1. 下载安装chrome webdriver `https://sites.google.com/chromium.org/driver/downloads?authuser=0`
2. 安装selenium `pip install seleuim`

### 执行代码

- 如果有一些网站需要登录，可以执行以下命令启动一个常驻浏览器，并且将用户信息写到指定路径

```bash
# 针对macos 上的Chrome 浏览器
export PATH="/Applications/Google Chrome.app/Contents/MacOS:$PATH"
Google\ Chrome --remote-debugging-port=9222 --user-data-dir="~/ChromeProfile"
```

- 经过以上操作就会启动一个浏览器，后续使用代码可以控制该浏览器上的行为。

```python
from selenium import webdriver # selenium.__version__ = 4.8.0
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
import time


'''
如果想要保持登录状态：
打开一个terminal执行以下命令：
export PATH="/Applications/Google Chrome.app/Contents/MacOS:$PATH"
Google\ Chrome --remote-debugging-port=9222 --user-data-dir="~/ChromeProfile"

启动chrome驻留之后再执行以下代码
'''

# 打开浏览器驱动
option = webdriver.ChromeOptions()
option.add_experimental_option("debuggerAddress", "127.0.0.1:9222")

# 启动浏览器
driver = webdriver.Chrome(options = option)
driver.implicitly_wait(10)

class ServiceConfig():

    # 定义prepareWork函数，做准备工作
    def prepareWork(self,url):
        # 打开百度首页
        driver.get(url)

        # 查找搜索框元素
        search_input = driver.find_element(By.XPATH,'//*[@id="root"]/div[1]/div[2]/div/div[2]/div[1]/div/div/div/input')

        # 在搜索框中输入文本
        search_input.send_keys("人体工学椅子")
        # time.sleep(2)

        # 点击搜索按钮
        search_button = driver.find_element(By.XPATH,'//*[@id="root"]/div[1]/div[2]/div/div[2]/div[1]/div/button/span')
        ActionChains(driver).move_to_element(search_button).click().perform()
        # time.sleep(2)

        setting_button = driver.find_element(By.XPATH,'//*[@id="root"]/div[2]/div/div[3]/div/div/div/div[1]/div[2]/p[1]')
        ActionChains(driver).move_to_element(setting_button).click().perform()
        # time.sleep(2)
        windows = driver.window_handles
        driver.switch_to.window(windows[-1])

        sousuo_setting = driver.find_element(By.XPATH,'//*[@id="root"]/div[2]/div/div[3]/div[2]/div[5]/span[1]/button[1]/span')
        ActionChains(driver).move_to_element(sousuo_setting).click().perform()



if __name__ == '__main__':
    url = 'https://www.byte-mall.cn/'
    sc = ServiceConfig()
    sc.prepareWork(url)
    time.sleep(10000)
    

```

- 具体其他复杂操作可以通过组合鼠标和键盘操作事件来实现

<div data-hk-top-pages="5"> 

</div>
